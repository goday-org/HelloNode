{"ts":1368176673028,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\n/**\n * Module dependencies.\n */\n\nvar flash = require(\"connect-flash\") \n  ,express = require('express')\n  , routes = require('./routes')\n  , http = require('http')\n  , path = require('path')\n  , MongoStore = require(\"connect-mongo\")(express)\n  , settings = require(\"./settings\");\n\nvar app = express();\n\n// all environments\napp.set('port', process.env.PORT || 3000);\napp.set('views', __dirname + '/views');\napp.set('view engine', 'jade');\napp.use(express.favicon());\napp.use(express.logger('dev'));\napp.use(express.bodyParser());\napp.use(express.methodOverride());\napp.use(express.cookieParser());\napp.use(express.session({\nsecret: settings.cookieSecret,\nstore: new MongoStore({\ndb: settings.db\n})}));\napp.use(flash());\n\napp.use(function(req, res, next){\n    //current user\n    res.locals.user = req.session.user;\n    \n    //error message\n    var err = req.flash('error');\n    if(err.length)  \n        res.locals.error = err;\n    else\n        res.locals.error = null;\n        \n    //success message\n    var succ = req.flash('success');\n    if(succ.length) \n        res.locals.success = succ;\n    else \n        res.locals.success = null;\n        \n    next();\n});\n\napp.use(app.router);\napp.use(express.static(path.join(__dirname, 'public')));\nroutes(app);\n\n// development only\nif ('development' == app.get('env')) {\n  app.use(express.errorHandler());\n}\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  console.log('Express server listening on port ' + app.get('port'));\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":1484}]],"length":1484}
